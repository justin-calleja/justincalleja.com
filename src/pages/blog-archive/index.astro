---
import merge from 'lodash.merge';
import List from '~/components/blog-archive/List.astro';
// import type { ImageMetadata } from 'astro';
import Layout from '~/layouts/PageLayout.astro';
// import SinglePost from '~/components/blog/SinglePost.astro';
// import ToBlogLink from '~/components/blog/ToBlogLink.astro';

// import { getCanonical, getPermalink } from '~/utils/permalinks';
import {
  getStaticPathsBlogPost,
  // blogPostRobots
} from '~/utils/blog';
// import { findImage } from '~/utils/images';

export const prerender = true;

export async function getStaticPaths() {
  return await getStaticPathsBlogPost();
}

// const { post } = Astro.props;

// const url = getCanonical(getPermalink(post.permalink, 'post'));
// const image = (await findImage(post.image)) as ImageMetadata | undefined;

const metadata = merge(
  {
    title: 'Blog Archive',
    description: 'Contains links to archived blog posts',
  }
  // { ...(post?.metadata ? { ...post.metadata, canonical: post.metadata?.canonical || url } : {}) }
);
---

<Layout metadata={metadata}>
  <section class="py-8 sm:py-16 lg:py-20 mx-auto">
    <article>
      <div class="flex justify-between flex-col sm:flex-row max-w-3xl mx-auto mt-0 mb-2 px-4 sm:px-6 sm:items-center">
        <List
          archivedPosts={[
            {
              link: 'https://github.com/justin-calleja/justincalleja.com/blob/archive-1/src/posts/2014/setting-up-karma-with-mocha-chai-and-requirejs/index.mdx',
              title: 'Setting up Karma with Mocha, Chai, and RequireJS',
            },
            {
              link: 'https://github.com/justin-calleja/justincalleja.com/blob/archive-1/src/posts/2014/taking-the-express-route-out/taking-the-express-route-out.mdx',
              title: 'Taking the Express route out',
            },

            {
              link: 'https://github.com/justin-calleja/justincalleja.com/blob/archive-1/src/posts/2014/to-mock-a-mongoose/index.mdx',
              title: 'To mock a Mongoose',
            },
            {
              link: 'https://github.com/justin-calleja/justincalleja.com/blob/archive-1/src/posts/2014/using-viper-for-some-go-basics/using-viper-for-some-go-basics.mdx',
              title: 'Using Viper for some Go basics',
            },
          ]}
        />
      </div>
    </article>
  </section>
</Layout>
